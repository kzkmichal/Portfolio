(function(a,b,c){'use strict';"undefined"!=typeof window&&"function"==typeof define&&define.amd?define(c):"undefined"!=typeof module&&module.exports?module.exports=c():b.exports?b.exports=c():b[a]=c()})("ccWebRecorderInit",this,function(){'use-strict';const a=()=>{const a="cc_ios_fp",b="cc_page_id",c="cc_visit_id",d="cc_save_step",e=()=>{for(var a=Math.floor,b=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],c="",d=0;36>d;d++)c+=8==d||13===d||18===d||23===d?"-":b[a(Math.random()*b.length)];return c},f=a=>localStorage.getItem(a),g=a=>localStorage.setItem(a,e()),h=a=>sessionStorage.getItem(a),i=a=>sessionStorage.setItem(a,e()),j=()=>{i(b),i(c)},k=({isStart:a,events:d})=>{const e=a?"start":"events",f=location.href,g={action:e,page_id:h(b),visit_id:h(c),location:f,action_log:{events:d}};return JSON.stringify(g)},l=()=>{let a=document.body,b=document.documentElement;return{window_inner_width:window.innerWidth,window_inner_height:window.innerHeight,window_outer_width:window.outerWidth,window_outer_height:window.outerHeight,window_screen_width:window.screen.width,window_screen_height:window.screen.height,body_scroll_width:a.scrollWidth,body_scroll_height:a.scrollHeight,body_offset_width:a.offsetWidth,body_offset_height:a.offsetHeight,html_client_width:b.clientWidth,html_client_height:b.clientHeight,html_scroll_width:b.scrollWidth,html_scroll_height:b.scrollHeight,html_offset_width:b.offsetWidth,html_offset_height:b.offsetHeight}},m=a=>/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(a),n=()=>{let a=[],e=!1,f=0,g=5e3,i=h(d)||0;ccWebRecorder({emit(b){4==b.type&&(b.user_agent=encodeURIComponent(navigator.userAgent.replace("\"","")),b.sizes=l()),a.push(b)}}),window.addEventListener("beforeunload",async()=>{e&&(await j())});const j=()=>{if(i++,sessionStorage.setItem(d,i),g*i>6e4)return console.log("session ended"),sessionStorage.removeItem(c),sessionStorage.removeItem(b),clearInterval(f);if(0!=a.length){if(!m(h(c))||!m(h(b)))return console.error("No visit id or page id"),console.log(c,h(c)),console.log(b,h(b)),clearInterval(f);const d=k({isStart:!e,events:a});return a=[],e=!0,fetch("https://monitor.clickcease.com/V2/recorder/entry2",{method:"POST",headers:{"Content-Type":"application/json"},body:d})}};j(),f=setInterval(j,g)},o=async a=>{const d=await fetch("https://monitor.clickcease.com/monitor/api/statsV2",{method:"post",body:JSON.stringify(a)}).then(a=>a.json());1==d&&(h(c)?i(b):j(),n())};if((()=>{if(h(c))return!0;var{hash:a,search:b}=window.location,d=!1;return["gclid","msclkid","utm"].forEach(c=>{(a.includes(c)||b.includes(c))&&(d=!0)}),d})()){const b=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(b){f(a)||g(a);const b=f(a),c=decodeURI(document.referrer),d={referrer:c,Fp:b,href:window.location.href};o(d)}else try{window.Fingerprint2.getV18(async a=>{const b=decodeURI(document.referrer),c={referrer:b,Fp:a,href:window.location.href};o(c)})}catch(a){console.error("err:",a)}}},b=()=>{"complete"===document.readyState&&a()};return document.addEventListener("readystatechange",()=>{b()}),b(),{name:"cc_init",context:this}});